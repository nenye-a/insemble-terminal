# Migration `20200527152336-comparation-perfomance`

This migration has been generated by RaymondAnggara at 5/27/2020, 3:23:36 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."ComparePerformanceData" (
    "avgRating" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "numLocation" integer   ,
    "numReview" integer  NOT NULL DEFAULT 0,
    "performance" text   ,
    "totalSales" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."ComparationTag" (
    "businessTag" text   ,
    "id" text  NOT NULL ,
    "locationTag" text   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."_ComparationTagToPerformance" (
    "A" text  NOT NULL ,
    "B" text  NOT NULL 
) 

CREATE UNIQUE INDEX "_ComparationTagToPerformance_AB_unique" ON "public"."_ComparationTagToPerformance"("A","B")

ALTER TABLE "public"."ComparePerformanceData" ADD FOREIGN KEY ("performance") REFERENCES "public"."Performance"("id") ON DELETE SET NULL

ALTER TABLE "public"."ComparationTag" ADD FOREIGN KEY ("locationTag") REFERENCES "public"."LocationTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."ComparationTag" ADD FOREIGN KEY ("businessTag") REFERENCES "public"."BusinessTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."_ComparationTagToPerformance" ADD FOREIGN KEY ("A") REFERENCES "public"."ComparationTag"("id") ON DELETE CASCADE

ALTER TABLE "public"."_ComparationTagToPerformance" ADD FOREIGN KEY ("B") REFERENCES "public"."Performance"("id") ON DELETE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200519160618-search-log-init..20200527152336-comparation-perfomance
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -96,14 +96,32 @@
   numReview     Int
   numLocation   Int? 
 }
+model ComparePerformanceData {
+  id            String @default(cuid()) @id
+  name          String
+  avgRating     String
+  totalSales    String
+  numReview     Int
+  numLocation   Int? 
+}
+
+model ComparationTag {
+  id              String            @default(cuid()) @id
+  locationTag     LocationTag?
+  businessTag     BusinessTag?
+  performance     Performance[]
+}
+
 model Performance {
   id              String            @default(cuid()) @id
   type            PerformanceType
   locationTag     LocationTag?
   businessTag     BusinessTag?
+  comparationTags ComparationTag[]
   data            PerformanceData[]
+  compareData     ComparePerformanceData[]
   createdAt       DateTime          @default(now())
   updatedAt       DateTime          @updatedAt
 }
```


