# Migration `20200518160051-performance-data-model-init`

This migration has been generated by RaymondAnggara at 5/18/2020, 4:00:51 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."LocationTag" (
    "id" text  NOT NULL ,
    "params" text  NOT NULL DEFAULT '',
    "type" text  NOT NULL DEFAULT 'ADDRESS',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."BusinessTag" (
    "id" text  NOT NULL ,
    "params" text  NOT NULL DEFAULT '',
    "type" text  NOT NULL DEFAULT 'BUSINESS',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."PerformanceData" (
    "avgRating" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "numLocation" integer   ,
    "numReview" integer  NOT NULL DEFAULT 0,
    "performance" text   ,
    "totalSales" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Performance" (
    "businessTag" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "locationTag" text   ,
    "type" text  NOT NULL DEFAULT 'BRAND',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."PerformanceData" ADD FOREIGN KEY ("performance") REFERENCES "public"."Performance"("id") ON DELETE SET NULL

ALTER TABLE "public"."Performance" ADD FOREIGN KEY ("locationTag") REFERENCES "public"."LocationTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."Performance" ADD FOREIGN KEY ("businessTag") REFERENCES "public"."BusinessTag"("id") ON DELETE SET NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200518130358-auth-user..20200518160051-performance-data-model-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,13 +1,47 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
 }
+enum LocationTagType {
+  ADDRESS
+  CITY
+  COUNTY
+  STATE
+  NATION
+}
+
+enum BusinessType {
+  BUSINESS
+  CATEGORY
+}
+
+enum PerformanceType {
+  BRAND
+  CATEGORY
+  OVERALL
+  ADDRESS
+  CITY
+  STATE
+}
+
+model LocationTag {
+  id     String          @default(cuid()) @id
+  type   LocationTagType
+  params String
+}
+
+model BusinessTag {
+  id     String       @default(cuid()) @id
+  type   BusinessType
+  params String
+}
+
 model User {
   id            String   @default(cuid()) @id
   email         String   @unique
   avatar        String?
@@ -44,4 +78,23 @@
   user       User
   verified   Boolean @default(false)
   tokenEmail String
 }
+
+model PerformanceData {
+  id            String @default(cuid()) @id
+  name          String
+  avgRating     String
+  totalSales    String
+  numReview     Int
+  numLocation   Int? 
+}
+
+model Performance {
+  id              String            @default(cuid()) @id
+  type            PerformanceType
+  locationTag     LocationTag?
+  businessTag     BusinessTag?
+  data            PerformanceData[]
+  createdAt       DateTime          @default(now())
+  updatedAt       DateTime          @updatedAt
+}
```


