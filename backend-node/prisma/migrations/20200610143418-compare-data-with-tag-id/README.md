# Migration `20200610143418-compare-data-with-tag-id`

This migration has been generated by RaymondAnggara at 6/10/2020, 2:34:18 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_ActivityToComparationTag" (
    "A" text  NOT NULL ,
    "B" text  NOT NULL 
) 

CREATE TABLE "public"."_ComparationTagToCoverage" (
    "A" text  NOT NULL ,
    "B" text  NOT NULL 
) 

ALTER TABLE "public"."ComparePerformanceData" ADD COLUMN "compareId" text  NOT NULL DEFAULT '';

ALTER TABLE "public"."ComparationTag" DROP COLUMN "activity",
DROP COLUMN "coverage";

ALTER TABLE "public"."CompareNewsData" ADD COLUMN "compareId" text  NOT NULL DEFAULT '';

ALTER TABLE "public"."CompareActivityData" ADD COLUMN "compareId" text  NOT NULL DEFAULT '';

ALTER TABLE "public"."CompareCoverageData" ADD COLUMN "compareId" text  NOT NULL DEFAULT '';

CREATE UNIQUE INDEX "_ActivityToComparationTag_AB_unique" ON "public"."_ActivityToComparationTag"("A","B")

CREATE UNIQUE INDEX "_ComparationTagToCoverage_AB_unique" ON "public"."_ComparationTagToCoverage"("A","B")

ALTER TABLE "public"."_ActivityToComparationTag" ADD FOREIGN KEY ("A") REFERENCES "public"."Activity"("id") ON DELETE CASCADE

ALTER TABLE "public"."_ActivityToComparationTag" ADD FOREIGN KEY ("B") REFERENCES "public"."ComparationTag"("id") ON DELETE CASCADE

ALTER TABLE "public"."_ComparationTagToCoverage" ADD FOREIGN KEY ("A") REFERENCES "public"."ComparationTag"("id") ON DELETE CASCADE

ALTER TABLE "public"."_ComparationTagToCoverage" ADD FOREIGN KEY ("B") REFERENCES "public"."Coverage"("id") ON DELETE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200609140343-performance-data-nullable..20200610143418-compare-data-with-tag-id
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -154,16 +154,19 @@
   avgRating   String?
   totalSales  String?
   numReview   Int?
   numLocation Int?
+  compareId   String
 }
 model ComparationTag {
   id          String        @default(cuid()) @id
   locationTag LocationTag?
   businessTag BusinessTag?
   performance Performance[]
   news        News[]
+  activity    Activity[]
+  coverage    Coverage[]
 }
 model Performance {
   id              String                   @default(cuid()) @id
@@ -194,8 +197,9 @@
   published   String
   source      String
   description String
   relevance   Float
+  compareId   String
 }
 model News {
   id              String            @default(cuid()) @id
@@ -227,8 +231,9 @@
   id           String        @default(cuid()) @id
   name         String
   location     String
   activityData String
+  compareId    String
 }
 model Activity {
   id              String                @default(cuid()) @id
@@ -254,8 +259,9 @@
   name         String
   location     String
   numLocations Int?
   coverageData String
+  compareId    String
 }
 model Coverage {
   id              String                @default(cuid()) @id
```


