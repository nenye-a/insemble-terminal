# Migration `20200602164616-ownership-init`

This migration has been generated by RaymondAnggara at 6/2/2020, 4:46:16 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."OwnershipContactData" (
    "email" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "ownershipContact" text   ,
    "phone" text  NOT NULL DEFAULT '',
    "title" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."OwnershipContact" (
    "businessTag" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "locationTag" text   ,
    "type" text  NOT NULL DEFAULT 'PROPERTY',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."OwnershipInfoData" (
    "headquarters" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "lastUpdate" text  NOT NULL DEFAULT '',
    "parentCompany" text  NOT NULL DEFAULT '',
    "phone" text  NOT NULL DEFAULT '',
    "website" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."OwnershipInfo" (
    "businessTag" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "data" text  NOT NULL ,
    "id" text  NOT NULL ,
    "locationTag" text   ,
    "type" text  NOT NULL DEFAULT 'PROPERTY',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."OwnershipContactData" ADD FOREIGN KEY ("ownershipContact") REFERENCES "public"."OwnershipContact"("id") ON DELETE SET NULL

ALTER TABLE "public"."OwnershipContact" ADD FOREIGN KEY ("locationTag") REFERENCES "public"."LocationTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."OwnershipContact" ADD FOREIGN KEY ("businessTag") REFERENCES "public"."BusinessTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."OwnershipInfo" ADD FOREIGN KEY ("locationTag") REFERENCES "public"."LocationTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."OwnershipInfo" ADD FOREIGN KEY ("businessTag") REFERENCES "public"."BusinessTag"("id") ON DELETE SET NULL

ALTER TABLE "public"."OwnershipInfo" ADD FOREIGN KEY ("data") REFERENCES "public"."OwnershipInfoData"("id") ON DELETE RESTRICT
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200602123030-remove-coverage-business..20200602164616-ownership-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -36,8 +36,13 @@
   OWNERSHIP
   COVERAGE
 }
+enum OwnershipType {
+  PROPERTY
+  COMPANY
+}
+
 model LocationTag {
   id     String          @default(cuid()) @id
   type   LocationTagType
   params String
@@ -216,4 +221,41 @@
   compareData     CompareCoverageData[]
   createdAt       DateTime              @default(now())
   updatedAt       DateTime              @updatedAt
 }
+
+model OwnershipContactData {
+  id    String @default(cuid()) @id
+  name  String
+  title String
+  phone String
+  email String
+}
+
+model OwnershipContact {
+  id          String                 @default(cuid()) @id
+  type        OwnershipType
+  locationTag LocationTag?
+  businessTag BusinessTag?
+  data        OwnershipContactData[]
+  createdAt   DateTime               @default(now())
+  updatedAt   DateTime               @updatedAt
+}
+
+model OwnershipInfoData {
+  id            String @default(cuid()) @id
+  parentCompany String
+  headquarters  String
+  phone         String
+  website       String
+  lastUpdate    String
+}
+
+model OwnershipInfo {
+  id          String            @default(cuid()) @id
+  type        OwnershipType
+  locationTag LocationTag?
+  businessTag BusinessTag?
+  data        OwnershipInfoData
+  createdAt   DateTime          @default(now())
+  updatedAt   DateTime          @updatedAt
+}
```


